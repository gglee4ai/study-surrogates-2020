---
title: "Ch 03"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

```{r}
first.order <- function(x1, x2) {
  20 + 3*x1 - 1.5*x2
}
```

```{r}
x1 <- x2 <- seq(-2, 3.5, length=1000)
g <- expand.grid(x1, x2)
yhat <- matrix(first.order(g[,1], g[,2]), ncol=length(x2))
D <- rbind(c(-1,-1), c(-1,1), c(1,-1), c(1,1))
D
```

```{r}
cols <- heat.colors(128)
par(pty="s")
image(x1, x2, yhat, col=cols)
contour(x1, x2, yhat, add=TRUE)
points(D, pch=19)
points(0, 0)
arrows(0, 0, 3, -1.5)
```

```{r}
par(pty="s")
image(x1, x2, yhat, col=cols)
contour(x1, x2, yhat, add=TRUE)
points(D, pch=19)
points(0, 0)
arrows(0, 0, 3, -1.5)
library(plotrix)
draw.circle(0, 0, 1)
text(1, 0, "r1")
draw.circle(0, 0, 1.75)
text(1.75, 0, "r2 > r1")
```

```{r}
plasma <- read.table("dataset/plasma.txt", header=TRUE)
plasma
```

```{r}
library(magrittr)
fit.int <- lm(etch ~ x1*x2, data=plasma)
summary(fit.int)$coefficients %>% signif(digits=4)
```

```{r}
fit <- lm(etch ~ x1 + x2, data=plasma)
summary(fit)
coef(fit)
```

```{r}
b1 <- coef(fit)[2]
b2 <- coef(fit)[3]
delta2 <- abs(b2/b1)
delta2
```

```{r}
Dnew <- data.frame(x1=-1:-3, x2=(1:3)*delta2)
Dnew
```

```{r}
x1 <- seq(-4, 1.5, length=100)
x2 <- seq(-1.5, 4*delta2, length=100)
g <- expand.grid(x1=x1, x2=x2)
yhat <- matrix(predict(fit, newdata=g), ncol=length(x2))
```

```{r}
par(pty="s")
image(x1, x2, yhat, col=cols)
contour(x1, x2, yhat, add=TRUE)
points(plasma$x1, plasma$x2, pch=19)
points(0, 0)
arrows(0, 0, -3.5, 3.5*delta2)
points(Dnew)
```

```{r}
plasma.delta <- read.table("dataset/plasma_delta.txt", header=TRUE)
plasma.delta$p.etch <- predict(fit, newdata=plasma.delta[,4:5])
plasma.delta
```

```{r}
max(plasma$etch)
```



























